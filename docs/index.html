<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple size-structured resources in mizer • mizerMR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Multiple size-structured resources in mizer">
<meta property="og:description" content="An add-on to the mizer package which allows multiple resource spectra to be added to any mizer model.">
<meta property="og:image" content="https://sizespectrum.org/mizerMR/reference/figures/logo.png">
<meta property="og:image:alt" content="mizerMR: Multiple size-structured resources in mizer">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@mizer_model">
<meta name="twitter:site" content="@mizer_model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mizerMR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://blog.mizer.sizespectrum.org">Blog</a>
</li>
<li>
  <a href="https://twitter.com/mizer_model">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/sizespectrum/mizerMR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="mizermr-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#mizermr-" class="anchor"></a>mizerMR <a href="https://sizespectrum.org/mizerMR"><img src="reference/figures/logo.png" align="right" height="120"></a>
</h1></div>
<!-- badges: start -->

<p>This extension package for mizer allows you to work with multiple size-structured resources in the same way in which you work with multiple species in mizer.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"sizespectrum/mizerMR"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://sizespectrum.org/mizerMR/">mizerMR</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="setting-up-a-model-with-multiple-resources" class="section level1">
<h1 class="hasAnchor">
<a href="#setting-up-a-model-with-multiple-resources" class="anchor"></a>Setting up a model with multiple resources</h1>
<p>Multiple size-structured resources are set up in a very similar manner to multiple species. Just as for multiple species we need a <code>species_params</code> data frame with the information about the species, for multiple resources we need a <code>resource_params</code> data frame, with one row for each resource. Here is an artificial example with two resources:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="va">resource_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">resource</span>,  <span class="op">~</span><span class="va">kappa</span>, <span class="op">~</span><span class="va">lambda</span>, <span class="op">~</span><span class="va">r_pp</span>, <span class="op">~</span><span class="va">w_min</span>, <span class="op">~</span><span class="va">w_max</span>,
 <span class="st">"Resource 1"</span>,    <span class="fl">1e11</span>,    <span class="fl">2.13</span>,     <span class="fl">4</span>,    <span class="cn">NA</span> ,   <span class="fl">0.01</span>,
 <span class="st">"Resource 2"</span>,    <span class="fl">1e11</span>,    <span class="fl">2.05</span>,    <span class="fl">10</span>,   <span class="fl">1e-4</span>,     <span class="cn">NA</span>
<span class="op">)</span></code></pre></div>
<p>Similarly to how we can set resource parameters for a single resource in standard mizer with <code>setResource()</code>, you can now set multiple resources with <code><a href="reference/setMultipleResources.html">setMultipleResources()</a></code>. So if for example we wanted to add these resources to the North Sea model described by the <code>NS_params</code> MizerParams object, we would do</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/setMultipleResources.html">setMultipleResources</a></span><span class="op">(</span><span class="va">NS_params</span>, <span class="va">resource_params</span><span class="op">)</span></code></pre></div>
<p>This has given us a new MizerParams object in which the original resource has been replaced by our two resources. We can then work with this MizerParams object as usual. For example we can project it forward in time:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">project</span><span class="op">(</span><span class="va">params</span>, t_max <span class="op">=</span> <span class="fl">2</span>, t_save <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p>and plot the resulting spectra:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">sim</span>, power <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<p>We can also animate the spectra with <code><a href="reference/animateSpectra.html">animateSpectra(sim)</a></code>. Most mizer functions will work as usual.</p>
<p>We can access the simulation results for the resource with <code><a href="reference/NResource.html">NResource()</a></code>. This gives a three-dimensional array:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu"><a href="reference/NResource.html">NResource</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  num [1:11, 1:2, 1:226] 9.87e+37 9.87e+37 9.87e+37 9.87e+37 9.87e+37 ...</span>
<span class="co">#&gt;  - attr(*, "dimnames")=List of 3</span>
<span class="co">#&gt;   ..$ time    : chr [1:11] "0" "0.2" "0.4" "0.6" ...</span>
<span class="co">#&gt;   ..$ resource: chr [1:2] "Resource 1" "Resource 2"</span>
<span class="co">#&gt;   ..$ w       : chr [1:226] "2.12e-13" "2.53e-13" "3.02e-13" "3.61e-13" ...</span></code></pre></div>
<p>So the first dimension is the time, the second the resource and the third the size. Thus to get the abundance density of Resource 2 at time 0.6 at sizes between 0.1g and 5g we could do</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">select_w</span> <span class="op">&lt;-</span> <span class="fu">w_full</span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="fu">w_full</span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">5</span>
<span class="fu"><a href="reference/NResource.html">NResource</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span><span class="op">[</span><span class="st">"0.6"</span>, <span class="st">"Resource 2"</span>, <span class="va">select_w</span><span class="op">]</span>
<span class="co">#&gt;        1.18         1.4        1.68           2        2.39        2.85 </span>
<span class="co">#&gt; 29171099375 20197414266 14020889066  9759285393  6811166565  4765970415 </span>
<span class="co">#&gt;         3.4        4.06        4.84 </span>
<span class="co">#&gt;  3342985300  2349927216  1654807045</span></code></pre></div>
<p>This is perfectly analogous to how we would access the abundance density of fish species, except that the range of sizes is given by <code>w_full</code> rather than by <code>w</code>.</p>
</div>
<div id="more-details" class="section level1">
<h1 class="hasAnchor">
<a href="#more-details" class="anchor"></a>More details</h1>
<p>Just as we are able to specify how strongly a predator species interacts with a prey species via the <code>interaction</code> matrix, we can also specify how strongly a predator species interacts with each resource via the <code>resource_interaction</code>, which is a matrix with one row for each species and one column for each resource. For example</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">resource_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">12</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/setMultipleResources.html">setMultipleResources</a></span><span class="op">(</span><span class="va">NS_params</span>, <span class="va">resource_params</span>, <span class="va">resource_interaction</span><span class="op">)</span></code></pre></div>
<p>Resource parameters can be changed at any time. For example we can double the carrying capacity of the first resource with</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/resource_params.html">resource_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">kappa</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="reference/resource_params.html">resource_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">kappa</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<p>We can also use this kind of notation as an alternative to <code>setMultispeciesParams()</code>. For example</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="va">NS_params</span>
<span class="fu"><a href="reference/resource_params.html">resource_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">resource_params</span>
<span class="fu"><a href="reference/setMultipleResources.html">resource_interaction</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">resource_interaction</span></code></pre></div>
<p>By default the initial values for the resources will be equal to the carrying capacities. But if a user has their own array (resource x size) of resource number densities <code>my_n_resource</code> they can set these as the initial values with</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/setMultipleResources.html">initialNResource</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">my_n_resource</span></code></pre></div>
<p>Users who are not happy with the allometric expressions for the resource carrying capacities or the replenishment rates but have created their own matrices <code>my_capacity</code> and <code>my_rate</code> with one row for each resource and one column for each size can set these with</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/setMultipleResources.html">resource_capacity</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">my_capacity</span>
<span class="fu"><a href="reference/setMultipleResources.html">resource_rate</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">my_rate</span></code></pre></div>
<p>Rather than adding the multiple resources to an existing model, the user can also create a new model with multiple resources with</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/newMRParams.html">newMRParams</a></span><span class="op">(</span><span class="va">species_params</span>, <span class="va">interaction</span>, <span class="va">resource_params</span>,
                      <span class="va">resource_interaction</span>, <span class="va">gear_params</span><span class="op">)</span></code></pre></div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/sizespectrum/mizerMR/">https://​github.com/​sizespectrum/​mizerMR/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/sizespectrum/mizerMR/issues">https://​github.com/​sizespectrum/​mizerMR/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.york.ac.uk/maths/staff/gustav-delius/">Gustav Delius</a> <br><small class="roles"> Maintainer, author, copyright holder </small> <a href="https://orcid.org/0000-0003-4092-8228" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.york.ac.uk/maths/staff/gustav-delius/">Gustav Delius</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
